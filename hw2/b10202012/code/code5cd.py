from pwn import *
from Crypto.Util.number import long_to_bytes


admin_a = 2889018726779277304859608878059215229130014777970157213205549821947375725824782660790376471570290110214280477072860451815369096873945487570744684143395480859284178637884449515825768207632697132602507637506720647438856763915420280491584592992956393098989925993873361644366417716271814695011953173724647595718
admin_w = 143834271052212826958025425268067832877011276507139890958541106377356595010923310151402197284746700439245771490794563261583929588178518413153548436640205535636684061868048036329320505741710098504573383431987907195067341206267565758742026036709051040774013249507240829949438343929522771353233233327061473917088
bob = remote('cns.csie.org', 23462)

bob.sendlineafter(b' to me?', b'Admin')
bob.sendlineafter(b'a = ', str(admin_a).encode())
bob.sendlineafter(b'w = ', str(admin_w).encode())

flag3 = bob.recvuntil(b'\n')
bob.recvuntil(b'c1 = ')
c1 = bob.recvuntil(b'\n')
c1 = int(c1.decode().strip())
bob.recvuntil(b'c2 = ')
c2 = bob.recvuntil(b'\n')
c2 = int(c2.decode().strip())

bob.close()
print(flag3)

'''
$x$ is computed by the following in the (online tool)[https://shrek.unideb.hu/~tengely/crypto/section-6.html#subsection-26]
PohligHellman(11,473937504506436414041535538509294931346348680042860443536520331642145579104015202856896766224656813436541285126692050996761600170005762950346371287435297297112624802649992670271803443843475097312381420702060015479099874054986979802284624053312622785460981925643488908311577507968487433583437557495056175274767,661212642378546192924748624541024689740821842358380172364713618643459510023722305413088030182631492908841097127749562097350991966861367802894693769192651196097109493538162562798405156876034846778509975723794909609967301695307547686524372786580268393227198048625785038842430426659507104287249949976852788451803)
'''

p = 661212642378546192924748624541024689740821842358380172364713618643459510023722305413088030182631492908841097127749562097350991966861367802894693769192651196097109493538162562798405156876034846778509975723794909609967301695307547686524372786580268393227198048625785038842430426659507104287249949976852788451803
x = 10120993828904478908068836397163728126260853544798148222651418917897741607240921343803003803491370553375331622746989829121404446975879567423500440041597734
flag4 = (c2 * pow(c1,-x, p)) % p
print(long_to_bytes(flag4))